groups:
- name: MongoDb
  rules:
  - alert: MongoDbAlert
    expr: rate(mongodb_op_counters_total{type="query"}[10m]) > 0.15 #regra
    for: 5s #tolerância (por quanto tempo precisa acontecer para disparar o alert)
    labels:
      team: mongodb
    annotations:
      titulo: "Muitas consultas ao banco de dados"
      descricao: "O {{ $labels.instance }} esta com muitas consultas"

- name: WebApi
  rules:
  - alert: WebApiManyAccess
    expr: sum(rate(http_requests_received_total[1m])) by (instance) > 1 #regra
    for: 30s #Não posso receber mais de 1 requisição por segundo durante 30s
    labels:
      team: webapi
    annotations:
      titulo: "Número alto de acessos"
      descricao: "{{ $labels.instance }} esta com um número alto de acessos ({{ $value }}s)"